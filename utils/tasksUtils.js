// utils/tasksUtils.js

export const TASKS_TRANSLATIONS = {
  en: {
    goodMorning: "Good Morning",
    goodAfternoon: "Good Afternoon",
    goodEvening: "Good Evening",
    summary: "You completed {{completed}} of {{total}} tasks",
    completed: "Completed",
    tasks: "Tasks",
    schedule: "Schedule",
    exams: "Exams",
    today: "Today",
    nextUp: "Next Up",
    noSchedule: "No schedule available",
    noExams: "No upcoming exams ðŸŽ‰",
    reviseTip: "Use this time to revise!",
    deleteCompletedTitle: "Delete Completed?",
    deleteCompletedMsg: "This will remove {{count}} tasks.",
    cancel: "Cancel",
    deleteAll: "Delete All",
    addTask: "Add Task",
    generatePlan: "Generate Plan",
    error: "Error",
    failedAddTask: "Failed to add task",
    failedDelete: "Failed to delete tasks",
    generateFailed: "Generation failed",
    greatJob: "Great Job!",
    allDoneSub: "You've crushed all your tasks for today.",
    days: "days",
    day: "day"
  },
  ar: {
    goodMorning: "ØµØ¨Ø§Ø­ Ø§Ù„Ø®ÙŠØ±",
    goodAfternoon: "Ù…Ø³Ø§Ø¡ Ø§Ù„Ø®ÙŠØ±",
    goodEvening: "Ù…Ø³Ø§Ø¡ Ø§Ù„Ø®ÙŠØ±",
    summary: "Ø£Ù†Ø¬Ø²Øª {{completed}} Ù…Ù† Ø£ØµÙ„ {{total}} Ù…Ù‡Ø§Ù…",
    completed: "Ø§Ù„Ù…ÙƒØªÙ…Ù„Ø©",
    tasks: "Ø§Ù„Ù…Ù‡Ø§Ù…",
    schedule: "Ø§Ù„Ø¬Ø¯ÙˆÙ„",
    exams: "Ø§Ù„Ø§Ù…ØªØ­Ø§Ù†Ø§Øª",
    today: "Ø§Ù„ÙŠÙˆÙ…",
    nextUp: "Ø§Ù„Ù‚Ø§Ø¯Ù…",
    noSchedule: "Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ø¬Ø¯ÙˆÙ„ Ù…ØªØ§Ø­ Ø­Ø§Ù„ÙŠØ§Ù‹",
    noExams: "Ù„Ø§ ØªÙˆØ¬Ø¯ Ø§Ù…ØªØ­Ø§Ù†Ø§Øª Ù‚Ø§Ø¯Ù…Ø© ðŸŽ‰",
    reviseTip: "Ø§Ø³ØªØºÙ„ Ø§Ù„ÙˆÙ‚Øª Ù„Ù„Ù…Ø±Ø§Ø¬Ø¹Ø©!",
    deleteCompletedTitle: "Ø­Ø°Ù Ø§Ù„Ù…ÙƒØªÙ…Ù„Ø©ØŸ",
    deleteCompletedMsg: "Ø³ÙŠØªÙ… Ø­Ø°Ù {{count}} Ù…Ù‡Ø§Ù… Ù…ÙƒØªÙ…Ù„Ø©.",
    cancel: "Ø¥Ù„ØºØ§Ø¡",
    deleteAll: "Ø­Ø°Ù Ø§Ù„ÙƒÙ„",
    addTask: "Ø¥Ø¶Ø§ÙØ© Ù…Ù‡Ù…Ø©",
    generatePlan: "ØªÙˆÙ„ÙŠØ¯ Ø®Ø·Ø©",
    error: "Ø®Ø·Ø£",
    failedAddTask: "ÙØ´Ù„ Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù…Ù‡Ù…Ø©",
    failedDelete: "ÙØ´Ù„ Ø§Ù„Ø­Ø°Ù",
    generateFailed: "ÙØ´Ù„ Ø§Ù„ØªÙˆÙ„ÙŠØ¯",
    greatJob: "Ø¹Ù…Ù„ Ø±Ø§Ø¦Ø¹!",
    allDoneSub: "Ù„Ù‚Ø¯ Ø£Ù†Ù‡ÙŠØª Ø¬Ù…ÙŠØ¹ Ù…Ù‡Ø§Ù…Ùƒ Ù„Ù„ÙŠÙˆÙ….",
    days: "Ø£ÙŠØ§Ù…",
    day: "ÙŠÙˆÙ…"
  },
  fr: {
    goodMorning: "Bonjour",
    goodAfternoon: "Bon aprÃ¨s-midi",
    goodEvening: "Bonsoir",
    summary: "Vous avez terminÃ© {{completed}} sur {{total}} tÃ¢ches",
    completed: "TerminÃ©",
    tasks: "TÃ¢ches",
    schedule: "Emploi",
    exams: "Examens",
    today: "Aujourd'hui",
    nextUp: "Ã€ suivre",
    noSchedule: "Aucun emploi du temps",
    noExams: "Pas d'examens Ã  venir ðŸŽ‰",
    reviseTip: "Profitez-en pour rÃ©viser !",
    deleteCompletedTitle: "Supprimer les terminÃ©s ?",
    deleteCompletedMsg: "Cela supprimera {{count}} tÃ¢ches.",
    cancel: "Annuler",
    deleteAll: "Tout supprimer",
    addTask: "Ajouter",
    generatePlan: "GÃ©nÃ©rer",
    error: "Erreur",
    failedAddTask: "Ã‰chec de l'ajout",
    failedDelete: "Ã‰chec de la suppression",
    generateFailed: "Ã‰chec de la gÃ©nÃ©ration",
    greatJob: "Beau travail !",
    allDoneSub: "Vous avez terminÃ© toutes vos tÃ¢ches.",
    days: "jours",
    day: "jour"
  }
};

export const calculateDuration = (start, end, lang) => {
  if (!start || !end) return '--';
  const [startH, startM] = start.split(':').map(Number);
  const [endH, endM] = end.split(':').map(Number);
  const startTotal = startH * 60 + startM;
  const endTotal = endH * 60 + endM;
  let diff = endTotal - startTotal;
  if (diff <= 0) return '0';
  const hours = Math.floor(diff / 60);
  const minutes = diff % 60;
  const isAr = lang === 'ar';
  const hLabel = isAr ? 'Ø³Ø§' : 'h';
  const mLabel = isAr ? 'Ø¯' : 'min';
  if (hours > 0 && minutes > 0) return `${hours}${hLabel} ${minutes}${mLabel}`;
  if (hours > 0) return `${hours}${hLabel}`;
  return `${minutes}${mLabel}`;
};

export const localT = (key, lang, params = {}) => {
  const dict = TASKS_TRANSLATIONS[lang] || TASKS_TRANSLATIONS['en'];
  let text = dict[key] || TASKS_TRANSLATIONS['en'][key] || key;
  Object.keys(params).forEach(param => {
    text = text.replace(`{{${param}}}`, params[param]);
  });
  return text;
};

export const getDaysString = (days, lang) => {
  if (days === 0) return localT('today', lang) + '!';
  if (lang === 'ar') {
    if (days === 1) return 'ÙŠÙˆÙ… ÙˆØ§Ø­Ø¯';
    if (days === 2) return 'ÙŠÙˆÙ…Ø§Ù†';
    if (days >= 3 && days <= 10) return `${days} Ø£ÙŠØ§Ù…`;
    return `${days} ÙŠÙˆÙ…Ø§Ù‹`;
  }
  const suffix = days > 1 ? (lang === 'fr' ? 's' : 's') : ''; 
  const word = lang === 'fr' ? 'jour' : 'day';
  return `${days} ${word}${suffix}`;
};